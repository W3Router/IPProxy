# 数据库操作清单

## 一、数据库查询操作

### 1. 账户查询
- 代理商账户信息查询
  * 按账号查询
  * 按状态查询
  * 查询代理商余额
  * 查询代理商下属用户列表

- 用户账户信息查询
  * 按账号查询（支持模糊匹配）
  * 按所属代理商查询
  * 按状态查询
  * 查询用户资源使用情况

### 2. 订单查询
- 代理商订单查询
  * 按订单号查询
  * 按代理商账号查询
  * 按时间范围查询
  * 按额度变更类型查询（增加/扣减）

- 用户动态订单查询
  * 按订单号查询
  * 按用户账号查询
  * 按代理商账号查询
  * 按资源类型查询（动态资源1/2/3）
  * 按时间范围查询
  * 按状态查询

- 用户静态订单查询
  * 按订单号查询
  * 按用户账号查询
  * 按代理商账号查询
  * 按IP地址查询
  * 按状态查询
  * 按时间范围查询

### 3. IP资源查询
- 静态IP查询
  * 按IP地址查询
  * 按使用者查询
  * 按代理商查询
  * 按状态查询
  * 按资源类型查询（纯净静态1-7）
  * 查询IP详细信息（含端口/用户名/密码）

### 4. 统计数据查询
- 代理商统计
  * 查询累计充值
  * 查询累计消费
  * 查询剩余金额
  * 查询本月充值
  * 查询本月消费
  * 查询上月消费

- 资源使用统计
  * 查询动态资源使用情况
  * 查询静态资源使用情况
  * 查询资源使用率
  * 查询历史使用记录

## 二、数据库写入操作

### 1. 代理商管理
- 账户操作
  * 新增代理商账号
  * 修改代理商密码
  * 更新代理商状态
  * 更新代理商备注

- 额度操作
  * 代理商充值
  * 增加代理商额度
  * 扣减代理商额度

### 2. 用户管理
- 账户操作
  * 新增用户账号
  * 修改用户密码
  * 更新用户状态
  * 更新用户备注

### 3. 订单管理
- 代理商订单
  * 记录额度变更
  * 更新订单状态

- 用户动态订单
  * 创建流量订单
  * 更新订单状态
  * 记录流量使用

- 用户静态订单
  * 创建IP订单
  * 更新订单状态
  * 记录IP使用

### 4. IP资源管理
- IP操作
  * 更新IP状态
  * 记录IP分配
  * 更新IP开通时间
  * 更新IP到期时间
  * 记录IP续费

### 5. 系统设置
- 密码操作
  * 更新账户密码

### 6. 统计数据
- 资源统计
  * 更新动态资源使用记录
  * 更新静态资源使用记录
  * 更新充值消费记录
  * 更新统计数据

### 7. 系统同步
- IPIPV同步
  * 同步流量数据
  * 同步IP资源数据

## 三、数据库操作注意事项

### 1. 数据一致性
- 确保事务的原子性
- 保持多表数据一致
- 处理并发访问

### 2. 数据安全
- 记录操作日志
- 保存数据变更历史
- 定期数据备份

### 3. 性能优化
- 建立合适的索引
- 优化查询语句
- 控制查询范围

### 4. 异常处理
- 处理查询超时
- 处理写入失败
- 处理同步异常 